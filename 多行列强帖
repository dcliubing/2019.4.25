
Sub tee()
Dim hang, senu, hangs, ii, sh, e, coln, colns, colnss, toj, tojj, toi, f As Integer



Dim sjy, a, b, c, d As String
Dim arr2, arr3 As Variant
toj = 0
toi = 0

colns = ActiveCell.MergeArea.Columns.Count

colnss = Selection.Columns.Count

arr2 = Selection
hang = Selection.Row

ii = Selection.Column



sh = 0


'ReDim Preserve arr1(0 To 100)

Dim arr1(0 To 100)
Do

huan = ActiveSheet.Cells(hang, ii).MergeArea.Columns.Count



ii = ii + huan









arr1(toi) = toj + 1
toj = toj + huan
toi = toi + 1


 Loop Until toj = colnss









On Error Resume Next


'MsgBox senu
'If LBound(arr33) > UBound(arr33) Then   '判断数组是否为空


If Application.CountA(Selection) = 0 Then


MsgBox "未选择任何内容"


End If



arr3 = WorksheetFunction.Index(arr2, 0, arr1(2))


Selection.Columns(1) = arr3

a = 1
End Sub
